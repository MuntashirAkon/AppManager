(window.webpackJsonp=window.webpackJsonp||[]).push([[20],{370:function(a,s,e){"use strict";e.r(s);var t=e(25),n=Object(t.a)({},(function(){var a=this,s=a.$createElement,e=a._self._c||s;return e("ContentSlotsDistributor",{attrs:{"slot-key":a.$parent.slotKey}},[e("h1",{attrs:{id:"app-ops"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#app-ops"}},[a._v("#")]),a._v(" App Ops")]),a._v(" "),e("p",[e("em",[a._v("Go to the "),e("a",{attrs:{href:"https://github.com/MuntashirAkon/AppManager/issues/17",target:"_blank",rel:"noopener noreferrer"}},[a._v("related issue"),e("OutboundLink")],1),a._v(" for discussion.")])]),a._v(" "),e("details",{staticClass:"custom-block details"},[e("summary",[a._v("Table of Contents")]),a._v(" "),e("p"),e("div",{staticClass:"table-of-contents"},[e("ul",[e("li",[e("a",{attrs:{href:"#background"}},[a._v("Background")])]),e("li",[e("a",{attrs:{href:"#introduction-to-app-ops"}},[a._v("Introduction to App Ops")])]),e("li",[e("a",{attrs:{href:"#appopsmanager"}},[a._v("AppOpsManager")]),e("ul",[e("li",[e("a",{attrs:{href:"#op-constants"}},[a._v("OP_* Constants")])]),e("li",[e("a",{attrs:{href:"#mode-constants"}},[a._v("MODE_* Constants")])]),e("li",[e("a",{attrs:{href:"#packageops"}},[a._v("PackageOps")])]),e("li",[e("a",{attrs:{href:"#opentry"}},[a._v("OpEntry")])]),e("li",[e("a",{attrs:{href:"#usage"}},[a._v("Usage")])])])]),e("li",[e("a",{attrs:{href:"#appopsservice"}},[a._v("AppOpsService")])]),e("li",[e("a",{attrs:{href:"#appops-xml"}},[a._v("appops.xml")])]),e("li",[e("a",{attrs:{href:"#appops-command-line-interface"}},[a._v("appops command line interface")])])])]),e("p")]),a._v(" "),e("h2",{attrs:{id:"background"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#background"}},[a._v("#")]),a._v(" Background")]),a._v(" "),e("p",[e("strong",[a._v("App Ops")]),a._v(" (short hand for "),e("strong",[a._v("Application Operations")]),a._v(") are used by Android system (since Android 4.3) to control application permissions. The user "),e("em",[a._v("can")]),a._v(" control some permissions, but only the permissions that are considered dangerous (and Google thinks knowing your phone number isn't a dangerous thing). So, app ops seems to be the one we need if we want to install apps like Facebook and it's Messenger (which literary records everything) and still want "),e("em",[a._v("some")]),a._v(" privacy and/or security. Although certain features of app ops were available in Settings and later in hidden settings in older version of Android, it's completely hidden in newer versions of Android and is continued to be kept hidden. Now, any app with "),e("strong",[a._v("android.Manifest.permission.GET_APP_OPS_STATS")]),a._v(" permission can get the app ops information for other applications but this permission is hidden from users and can only be enabled using ADB or root. Still, the app with this permission cannot grant or revoke permissions (actually mode of operation) for apps other than itself (with limited capacity, of course). To modify the ops of other app, the app needs "),e("strong",[a._v("android.Manifest.permission.UPDATE_APP_OPS_STATS")]),a._v(" permissions which isn't accessible via "),e("em",[a._v("pm")]),a._v(" command. So, you cannot grant it via root or ADB, the permission is only granted to the system apps. There are very few apps who support disabling permissions via app ops. The best one to my knowledge is "),e("a",{attrs:{href:"https://github.com/8enet/AppOpsX",target:"_blank",rel:"noopener noreferrer"}},[a._v("AppOpsX"),e("OutboundLink")],1),a._v(". The main (visible) difference between my app (AppManager) and this app is that the later also provides you the ability to revoke internet permissions (by writing ip tables). Another difference is that the author used the hidden API to access/grant/revoke ops whereas I used "),e("a",{attrs:{href:"#appops-command-line-interface"}},[e("em",[a._v("appops")])]),a._v(" command-line tool to do that. I did this because of the limit of "),e("a",{attrs:{href:"https://stackoverflow.com/questions/37628",target:"_blank",rel:"noopener noreferrer"}},[a._v("Reflection"),e("OutboundLink")],1),a._v(" that Android recently imposed which rendered many hidden APIs unusable (there are some hacks but they may not work after the final release of R, I believe). One crucial problem that I faced during developing an API for App Ops is the lack of documentation in English language.")]),a._v(" "),e("h2",{attrs:{id:"introduction-to-app-ops"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#introduction-to-app-ops"}},[a._v("#")]),a._v(" Introduction to App Ops")]),a._v(" "),e("img",{attrs:{src:a.$withBase("/assets/how_app_ops_work.png"),alt:"How AppOps Works"}}),a._v(" "),e("p",[a._v("The figure (taken from "),e("a",{attrs:{href:"https://translate.googleusercontent.com/translate_c?depth=2&pto=aue&rurl=translate.google.com&sl=auto&sp=nmt4&tl=en&u=https://www.cnblogs.com/0616--ataozhijia/p/5009718.html&usg=ALkJrhgSo4IcKp2cXJlqttXuiRJZGa_jnw",target:"_blank",rel:"noopener noreferrer"}},[a._v("this article"),e("OutboundLink")],1),a._v(") above describes the process of changing and processing permission. "),e("a",{attrs:{href:"#appopsmanager"}},[e("strong",[a._v("AppOpsManager")])]),a._v(" can be used to manage permissions in Settings app. "),e("strong",[a._v("AppOpsManager")]),a._v(" is also useful in determining if a certain permission (or operation) is granted to the application. Most of the methods of "),e("strong",[a._v("AppOpsManager")]),a._v(" are accessible to the user app but unlike a system app, it can only be used to check permissions for any app or for the app itself and start or terminating certain operations. Moreover, not all operations are actually accessible from this Java class. "),e("strong",[a._v("AppOpsManager")]),a._v(" holds all the necessary constants such as "),e("a",{attrs:{href:"#op-constants"}},[e("em",[a._v("OP_*")])]),a._v(", "),e("code",[a._v("OPSTR_*")]),a._v(", "),e("a",{attrs:{href:"#mode-constants"}},[e("em",[a._v("MODE_*")])]),a._v(" which describes operation code, operation string and mode of operations respectively. It also holds necessary data stuctures such as "),e("a",{attrs:{href:"#packageops"}},[e("strong",[a._v("PackageOps")])]),a._v(" and "),e("strong",[a._v("OpEntry")]),a._v(". "),e("strong",[a._v("PackageOps")]),a._v(" holds "),e("strong",[a._v("OpEntry")]),a._v(" for a package, and "),e("strong",[a._v("OpEntry")]),a._v(", as the name suggests, describes each operation. Under the hood, "),e("strong",[a._v("AppOpsManager")]),a._v(" calls "),e("strong",[a._v("AppOpsService")]),a._v(" to perform any real work.")]),a._v(" "),e("p",[e("a",{attrs:{href:"https://android.googlesource.com/platform/frameworks/base/+/master/services/core/java/com/android/server/appop/AppOpsService.java",target:"_blank",rel:"noopener noreferrer"}},[e("strong",[a._v("AppOpService")]),e("OutboundLink")],1),a._v(" is completely hidden from a user application but acessible to the system applications. As seen in the picture, this is the class that does the actual management stuff. It contains data structures such as "),e("strong",[a._v("Ops")]),a._v(" to store basic package info and "),e("strong",[a._v("Op")]),a._v(" which is similar to "),e("strong",[a._v("OpEntry")]),a._v(" of "),e("strong",[a._v("AppOpsManager")]),a._v(". It also has "),e("strong",[a._v("Shell")]),a._v(" which is actually the source code of the "),e("em",[a._v("appops")]),a._v(" command line tool. It writes configurations to or read configurations from "),e("a",{attrs:{href:"#appops-xml"}},[a._v("/data/system/appops.xml")]),a._v(". System services calls "),e("strong",[a._v("AppOpsService")]),a._v(" to find out what an application is allowed and what is not allowed to perform, and "),e("strong",[a._v("AppOpsService")]),a._v(" determines these permissions by parsing "),e("code",[a._v("/data/system/appops.xml")]),a._v(". If no custom values are set in "),e("em",[a._v("appops.xml")]),a._v(", it returns the default mode available in "),e("strong",[a._v("AppOpsManager")]),a._v(".")]),a._v(" "),e("h2",{attrs:{id:"appopsmanager"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#appopsmanager"}},[a._v("#")]),a._v(" AppOpsManager")]),a._v(" "),e("p",[e("a",{attrs:{href:"https://android.googlesource.com/platform/frameworks/base/+/master/core/java/android/app/AppOpsManager.java",target:"_blank",rel:"noopener noreferrer"}},[a._v("AppOpsManager"),e("OutboundLink")],1),a._v(" stands for application operations manager. It consists of various constants and classes to modify app operations. Official documentation can be found "),e("a",{attrs:{href:"https://developer.android.com/reference/android/app/AppOpsManager",target:"_blank",rel:"noopener noreferrer"}},[a._v("here"),e("OutboundLink")],1),a._v(".")]),a._v(" "),e("h3",{attrs:{id:"op-constants"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#op-constants"}},[a._v("#")]),a._v(" OP_* Constants")]),a._v(" "),e("p",[e("code",[a._v("OP_*")]),a._v(" are the integer constants starting from "),e("code",[a._v("0")]),a._v(". "),e("code",[a._v("OP_NONE")]),a._v(" implies that no operations are specified whereas "),e("code",[a._v("_NUM_OP")]),a._v(" denotes the number of operations defined in "),e("code",[a._v("OP_*")]),a._v(" prefix.  These denotes each operations. But these operations are not necessarily unique. In fact, there are many operations that are actually a single operation denoted by multiple "),e("code",[a._v("OP_*")]),a._v(" constant (possibly for future use). Vendors may define their own op based on their requirements. MIUI is one of the vendors who are known to do that.")]),a._v(" "),e("p",[e("em",[a._v("Sneak-peek of "),e("code",[a._v("OP_*")]),a._v(":")])]),a._v(" "),e("div",{staticClass:"language-java line-numbers-mode"},[e("div",{staticClass:"highlight-lines"},[e("div",{staticClass:"highlighted"},[a._v(" ")]),e("br"),e("br"),e("br"),e("br"),e("br"),e("br"),e("br"),e("br"),e("div",{staticClass:"highlighted"},[a._v(" ")]),e("br")]),e("pre",{pre:!0,attrs:{class:"language-java"}},[e("code",[e("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("public")]),a._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("static")]),a._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("final")]),a._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("int")]),a._v(" OP_NONE "),e("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v(" "),e("span",{pre:!0,attrs:{class:"token operator"}},[a._v("-")]),e("span",{pre:!0,attrs:{class:"token number"}},[a._v("1")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("\n"),e("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("public")]),a._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("static")]),a._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("final")]),a._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("int")]),a._v(" OP_COARSE_LOCATION "),e("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[a._v("0")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("\n"),e("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("public")]),a._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("static")]),a._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("final")]),a._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("int")]),a._v(" OP_FINE_LOCATION "),e("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[a._v("1")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("\n"),e("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("public")]),a._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("static")]),a._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("final")]),a._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("int")]),a._v(" OP_GPS "),e("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[a._v("2")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("\n"),e("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("public")]),a._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("static")]),a._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("final")]),a._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("int")]),a._v(" OP_VIBRATE "),e("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[a._v("3")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("\n"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),a._v("\n"),e("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("public")]),a._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("static")]),a._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("final")]),a._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("int")]),a._v(" OP_READ_DEVICE_IDENTIFIERS "),e("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[a._v("89")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("\n"),e("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("public")]),a._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("static")]),a._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("final")]),a._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("int")]),a._v(" OP_ACCESS_MEDIA_LOCATION "),e("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[a._v("90")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("\n"),e("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("public")]),a._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("static")]),a._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("final")]),a._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("int")]),a._v(" OP_ACTIVATE_PLATFORM_VPN "),e("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[a._v("91")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("\n"),e("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("public")]),a._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("static")]),a._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("final")]),a._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("int")]),a._v(" _NUM_OP "),e("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[a._v("92")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("\n")])]),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[a._v("1")]),e("br"),e("span",{staticClass:"line-number"},[a._v("2")]),e("br"),e("span",{staticClass:"line-number"},[a._v("3")]),e("br"),e("span",{staticClass:"line-number"},[a._v("4")]),e("br"),e("span",{staticClass:"line-number"},[a._v("5")]),e("br"),e("span",{staticClass:"line-number"},[a._v("6")]),e("br"),e("span",{staticClass:"line-number"},[a._v("7")]),e("br"),e("span",{staticClass:"line-number"},[a._v("8")]),e("br"),e("span",{staticClass:"line-number"},[a._v("9")]),e("br"),e("span",{staticClass:"line-number"},[a._v("10")]),e("br")])]),e("p",[a._v("Whether an operation is unique is defined by "),e("a",{attrs:{href:"https://cs.android.com/android/platform/superproject/+/master:frameworks/base/core/java/android/app/AppOpsManager.java;drc=44cbdec292c6b234d94aae59257721cf499989ba;bpv=1;bpt=1;l=211?q=AppOpsManager&ss=android%2Fplatform%2Fsuperproject&gsn=sOpToSwitch&gs=kythe%3A%2F%2Fandroid.googlesource.com%2Fplatform%2Fsuperproject%3Flang%3Djava%3Fpath%3Dandroid.app.AppOpsManager%238ffb80c9b09fce58d7fe1a0af7d50fd025765d8f41e838fa3bc2754dd99d9c48",target:"_blank",rel:"noopener noreferrer"}},[e("code",[a._v("sOpToSwitch")]),e("OutboundLink")],1),a._v(". It maps each operation to another operation or to itself (if it's a unique operation). For instance, "),e("code",[a._v("OP_FINE_LOCATION")]),a._v(" and "),e("code",[a._v("OP_GPS")]),a._v(" are mapped to "),e("code",[a._v("OP_COARSE_LOCATION")]),a._v(".")]),a._v(" "),e("p",[a._v("Each operation has a private name which are described by "),e("a",{attrs:{href:"https://cs.android.com/android/platform/superproject/+/master:frameworks/base/core/java/android/app/AppOpsManager.java;drc=44cbdec292c6b234d94aae59257721cf499989ba;bpv=1;bpt=1;l=311?gsn=sOpNames&gs=kythe%3A%2F%2Fandroid.googlesource.com%2Fplatform%2Fsuperproject%3Flang%3Djava%3Fpath%3Dandroid.app.AppOpsManager%234f77b221ad3e5d9212e217eadec0b78cd35717a3bf2d0f2bc642dea241e02d72",target:"_blank",rel:"noopener noreferrer"}},[e("code",[a._v("sOpNames")]),e("OutboundLink")],1),a._v(". These names are usually the same names as the constants without the "),e("code",[a._v("OP_")]),a._v(" prefix. Some operations have public names as well which are described by "),e("code",[a._v("sOpToString")]),a._v(". For instance, "),e("code",[a._v("OP_COARSE_LOCATION")]),a._v(" has the public name "),e("strong",[a._v("android:coarse_location")]),a._v(".")]),a._v(" "),e("p",[a._v("As a gradual process of moving permissions to app ops, there are already many permissions that are defined under some operations. These permissions are mapped in "),e("a",{attrs:{href:"https://cs.android.com/android/platform/superproject/+/master:frameworks/base/core/java/android/app/AppOpsManager.java;drc=44cbdec292c6b234d94aae59257721cf499989ba;bpv=1;bpt=1;l=361?gsn=sOpPerms&gs=kythe%3A%2F%2Fandroid.googlesource.com%2Fplatform%2Fsuperproject%3Flang%3Djava%3Fpath%3Dandroid.app.AppOpsManager%23230bc1462b07a3c1575477761782a9d3537d75b4ea0a16748082c74f50bc2814",target:"_blank",rel:"noopener noreferrer"}},[e("code",[a._v("sOpPerms")]),e("OutboundLink")],1),a._v(". For example, the permission "),e("strong",[a._v("android.Manifest.permission.ACCESS_COARSE_LOCATION")]),a._v(" is mapped to "),e("code",[a._v("OP_COARSE_LOCATION")]),a._v(". Some operations may not have any associated permissions which have "),e("code",[a._v("null")]),a._v(" values.")]),a._v(" "),e("p",[a._v("As described in the previous section, operations that are configured for an app are stored at "),e("a",{attrs:{href:"#appops-xml"}},[a._v("/data/system/appops.xml")]),a._v(". If an operation is not configured, then whether system will allow that operation is determined from "),e("a",{attrs:{href:"https://cs.android.com/android/platform/superproject/+/master:frameworks/base/core/java/android/app/AppOpsManager.java;drc=44cbdec292c6b234d94aae59257721cf499989ba;bpv=1;bpt=1;l=410?gsn=sOpDefaultMode&gs=kythe%3A%2F%2Fandroid.googlesource.com%2Fplatform%2Fsuperproject%3Flang%3Djava%3Fpath%3Dandroid.app.AppOpsManager%23a8c8e4e247453a8ce329b2c1130f9c7a7f91e2b97d159c3e18c768b4d42f1b75",target:"_blank",rel:"noopener noreferrer"}},[e("code",[a._v("sOpDefaultMode")]),e("OutboundLink")],1),a._v(". It lists the "),e("em",[a._v("default mode")]),a._v(" for each operation.")]),a._v(" "),e("h3",{attrs:{id:"mode-constants"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#mode-constants"}},[a._v("#")]),a._v(" MODE_* Constants")]),a._v(" "),e("p",[e("code",[a._v("MODE_*")]),a._v(" constants also integer constants starting from "),e("code",[a._v("0")]),a._v(". These constants are assigned to each operations describing whether an app is authorised to perform that operation. These modes usually have associated names such as "),e("strong",[a._v("allow")]),a._v(" for "),e("code",[a._v("MODE_ALLOWED")]),a._v(", "),e("strong",[a._v("ignore")]),a._v(" for "),e("code",[a._v("MODE_IGNORED")]),a._v(", "),e("strong",[a._v("deny")]),a._v(" for "),e("code",[a._v("MODE_ERRORED")]),a._v(" (a rather misonomer), "),e("strong",[a._v("default")]),a._v(" for "),e("code",[a._v("MODE_DEFAULT")]),a._v(" and "),e("strong",[a._v("foreground")]),a._v(" for "),e("code",[a._v("MODE_FOREGROUND")]),a._v(".")]),a._v(" "),e("p",[e("em",[a._v("Default modes:")])]),a._v(" "),e("div",{staticClass:"language-java line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-java"}},[e("code",[e("span",{pre:!0,attrs:{class:"token comment"}},[a._v("/**\n * the given caller is allowed to perform the given operation.\n */")]),a._v("\n"),e("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("public")]),a._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("static")]),a._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("final")]),a._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("int")]),a._v(" MODE_ALLOWED "),e("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[a._v("0")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[a._v("/**\n * the given caller is not allowed to perform the given operation, and this attempt should\n * <em>silently fail</em> (it should not cause the app to crash).\n */")]),a._v("\n"),e("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("public")]),a._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("static")]),a._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("final")]),a._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("int")]),a._v(" MODE_IGNORED "),e("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[a._v("1")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[a._v("/**\n * the given caller is not allowed to perform the given operation, and this attempt should\n * cause it to have a fatal error, typically a {@link SecurityException}.\n */")]),a._v("\n"),e("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("public")]),a._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("static")]),a._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("final")]),a._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("int")]),a._v(" MODE_ERRORED "),e("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[a._v("1")]),a._v(" "),e("span",{pre:!0,attrs:{class:"token operator"}},[a._v("<<")]),a._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[a._v("1")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("  "),e("span",{pre:!0,attrs:{class:"token comment"}},[a._v("// 2")]),a._v("\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[a._v("/**\n * the given caller should use its default security check. This mode is not normally used\n */")]),a._v("\n"),e("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("public")]),a._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("static")]),a._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("final")]),a._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("int")]),a._v(" MODE_DEFAULT "),e("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[a._v("3")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[a._v('/**\n * Special mode that means "allow only when app is in foreground."\n */')]),a._v("\n"),e("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("public")]),a._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("static")]),a._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("final")]),a._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("int")]),a._v(" MODE_FOREGROUND "),e("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[a._v("1")]),a._v(" "),e("span",{pre:!0,attrs:{class:"token operator"}},[a._v("<<")]),a._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[a._v("2")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("\n")])]),a._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[a._v("1")]),e("br"),e("span",{staticClass:"line-number"},[a._v("2")]),e("br"),e("span",{staticClass:"line-number"},[a._v("3")]),e("br"),e("span",{staticClass:"line-number"},[a._v("4")]),e("br"),e("span",{staticClass:"line-number"},[a._v("5")]),e("br"),e("span",{staticClass:"line-number"},[a._v("6")]),e("br"),e("span",{staticClass:"line-number"},[a._v("7")]),e("br"),e("span",{staticClass:"line-number"},[a._v("8")]),e("br"),e("span",{staticClass:"line-number"},[a._v("9")]),e("br"),e("span",{staticClass:"line-number"},[a._v("10")]),e("br"),e("span",{staticClass:"line-number"},[a._v("11")]),e("br"),e("span",{staticClass:"line-number"},[a._v("12")]),e("br"),e("span",{staticClass:"line-number"},[a._v("13")]),e("br"),e("span",{staticClass:"line-number"},[a._v("14")]),e("br"),e("span",{staticClass:"line-number"},[a._v("15")]),e("br"),e("span",{staticClass:"line-number"},[a._v("16")]),e("br"),e("span",{staticClass:"line-number"},[a._v("17")]),e("br"),e("span",{staticClass:"line-number"},[a._v("18")]),e("br"),e("span",{staticClass:"line-number"},[a._v("19")]),e("br"),e("span",{staticClass:"line-number"},[a._v("20")]),e("br"),e("span",{staticClass:"line-number"},[a._v("21")]),e("br"),e("span",{staticClass:"line-number"},[a._v("22")]),e("br")])]),e("p",[a._v("Besides these default modes, vendors can set custom modes such as "),e("code",[a._v("MODE_ASK")]),a._v(" (with the name "),e("strong",[a._v("ask")]),a._v(") which is actively used by MIUI. MIUI also uses some other modes without any name associated with them.")]),a._v(" "),e("h3",{attrs:{id:"packageops"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#packageops"}},[a._v("#")]),a._v(" PackageOps")]),a._v(" "),e("p",[e("strong",[a._v("AppOpsManager.PackageOps")]),a._v(" is a data structure to store all the "),e("strong",[a._v("OpEntry")]),a._v(" for a package. In simple terms, it stores all the customised operations for a package.")]),a._v(" "),e("div",{staticClass:"language-java line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-java"}},[e("code",[e("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("public")]),a._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("static")]),a._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("class")]),a._v(" "),e("span",{pre:!0,attrs:{class:"token class-name"}},[a._v("PackageOps")]),a._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("implements")]),a._v(" "),e("span",{pre:!0,attrs:{class:"token class-name"}},[a._v("Parcelable")]),a._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("{")]),a._v("\n  "),e("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("private")]),a._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("final")]),a._v(" "),e("span",{pre:!0,attrs:{class:"token class-name"}},[a._v("String")]),a._v(" mPackageName"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("\n  "),e("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("private")]),a._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("final")]),a._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("int")]),a._v(" mUid"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("\n  "),e("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("private")]),a._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("final")]),a._v(" "),e("span",{pre:!0,attrs:{class:"token class-name"}},[a._v("List")]),e("span",{pre:!0,attrs:{class:"token generics"}},[e("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("<")]),e("span",{pre:!0,attrs:{class:"token class-name"}},[a._v("OpEntry")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(">")])]),a._v(" mEntries"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("\n  "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),a._v("\n"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("}")]),a._v("\n")])]),a._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[a._v("1")]),e("br"),e("span",{staticClass:"line-number"},[a._v("2")]),e("br"),e("span",{staticClass:"line-number"},[a._v("3")]),e("br"),e("span",{staticClass:"line-number"},[a._v("4")]),e("br"),e("span",{staticClass:"line-number"},[a._v("5")]),e("br"),e("span",{staticClass:"line-number"},[a._v("6")]),e("br")])]),e("p",[a._v("As can be seen above, it stores all "),e("strong",[a._v("OpEntry")]),a._v(" for a package as well as the corresponding package name and it's kernel user ID.")]),a._v(" "),e("h3",{attrs:{id:"opentry"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#opentry"}},[a._v("#")]),a._v(" OpEntry")]),a._v(" "),e("p",[e("strong",[a._v("AppOpsManager.OpEntry")]),a._v(" is a data structure that stores a single operation for any package.")]),a._v(" "),e("div",{staticClass:"language-java line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-java"}},[e("code",[e("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("public")]),a._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("static")]),a._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("final")]),a._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("class")]),a._v(" "),e("span",{pre:!0,attrs:{class:"token class-name"}},[a._v("OpEntry")]),a._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("implements")]),a._v(" "),e("span",{pre:!0,attrs:{class:"token class-name"}},[a._v("Parcelable")]),a._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("{")]),a._v("\n    "),e("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("private")]),a._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("final")]),a._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("int")]),a._v(" mOp"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("\n    "),e("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("private")]),a._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("final")]),a._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("boolean")]),a._v(" mRunning"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("\n    "),e("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("private")]),a._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("final")]),a._v(" "),e("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[a._v("@Mode")]),a._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("int")]),a._v(" mMode"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("\n    "),e("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("private")]),a._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("final")]),a._v(" "),e("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[a._v("@Nullable")]),a._v(" "),e("span",{pre:!0,attrs:{class:"token class-name"}},[a._v("LongSparseLongArray")]),a._v(" mAccessTimes"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("\n    "),e("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("private")]),a._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("final")]),a._v(" "),e("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[a._v("@Nullable")]),a._v(" "),e("span",{pre:!0,attrs:{class:"token class-name"}},[a._v("LongSparseLongArray")]),a._v(" mRejectTimes"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("\n    "),e("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("private")]),a._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("final")]),a._v(" "),e("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[a._v("@Nullable")]),a._v(" "),e("span",{pre:!0,attrs:{class:"token class-name"}},[a._v("LongSparseLongArray")]),a._v(" mDurations"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("\n    "),e("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("private")]),a._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("final")]),a._v(" "),e("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[a._v("@Nullable")]),a._v(" "),e("span",{pre:!0,attrs:{class:"token class-name"}},[a._v("LongSparseLongArray")]),a._v(" mProxyUids"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("\n    "),e("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("private")]),a._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("final")]),a._v(" "),e("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[a._v("@Nullable")]),a._v(" "),e("span",{pre:!0,attrs:{class:"token class-name"}},[a._v("LongSparseArray")]),e("span",{pre:!0,attrs:{class:"token generics"}},[e("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("<")]),e("span",{pre:!0,attrs:{class:"token class-name"}},[a._v("String")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(">")])]),a._v(" mProxyPackageNames"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("\n    "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),a._v("\n"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("}")]),a._v("\n")])]),a._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[a._v("1")]),e("br"),e("span",{staticClass:"line-number"},[a._v("2")]),e("br"),e("span",{staticClass:"line-number"},[a._v("3")]),e("br"),e("span",{staticClass:"line-number"},[a._v("4")]),e("br"),e("span",{staticClass:"line-number"},[a._v("5")]),e("br"),e("span",{staticClass:"line-number"},[a._v("6")]),e("br"),e("span",{staticClass:"line-number"},[a._v("7")]),e("br"),e("span",{staticClass:"line-number"},[a._v("8")]),e("br"),e("span",{staticClass:"line-number"},[a._v("9")]),e("br"),e("span",{staticClass:"line-number"},[a._v("10")]),e("br"),e("span",{staticClass:"line-number"},[a._v("11")]),e("br")])]),e("p",[a._v("Here:")]),a._v(" "),e("ul",[e("li",[e("code",[a._v("mOp")]),a._v(": Denotes one of the "),e("a",{attrs:{href:"#op-constants"}},[e("code",[a._v("OP_*")]),a._v(" constants")]),a._v(".")]),a._v(" "),e("li",[e("code",[a._v("mRunning")]),a._v(": Whether the operations is in progress (ie. the operation has started but not finished yet). Not all operations can be started or finished this way.")]),a._v(" "),e("li",[e("code",[a._v("mMOde")]),a._v(": One of the "),e("a",{attrs:{href:"#mode-constants"}},[e("code",[a._v("MODE_*")]),a._v(" constants")]),a._v(".")]),a._v(" "),e("li",[e("code",[a._v("mAccessTimes")]),a._v(": Stores all the available access times")]),a._v(" "),e("li",[e("code",[a._v("mRejectTimes")]),a._v(": Stores all the available reject times")]),a._v(" "),e("li",[e("code",[a._v("mDurations")]),a._v(": All available access durations, checking this with "),e("code",[a._v("mRunning")]),a._v(" will tell you for how long the app is performing a certain app operation.")]),a._v(" "),e("li",[e("code",[a._v("mProxyUids")]),a._v(": No documentation found")]),a._v(" "),e("li",[e("code",[a._v("mProxyPackageNames:")]),a._v(" No documentation found")])]),a._v(" "),e("h3",{attrs:{id:"usage"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#usage"}},[a._v("#")]),a._v(" Usage")]),a._v(" "),e("p",[a._v("TODO")]),a._v(" "),e("h2",{attrs:{id:"appopsservice"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#appopsservice"}},[a._v("#")]),a._v(" AppOpsService")]),a._v(" "),e("p",[a._v("TODO")]),a._v(" "),e("h2",{attrs:{id:"appops-xml"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#appops-xml"}},[a._v("#")]),a._v(" appops.xml")]),a._v(" "),e("p",[a._v("Latest "),e("code",[a._v("appops.xml")]),a._v(" has the following format: (This DTD is made by me and by no means perfect, has compatibility issues.)")]),a._v(" "),e("div",{staticClass:"language-dtd line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[a._v("<!DOCTYPE app-ops [\n\n<!ELEMENT app-ops (uid|pkg)*>\n<!ATTLIST app-ops v CDATA #IMPLIED>\n\n<!ELEMENT uid (op)*>\n<!ATTLIST uid n CDATA #REQUIRED>\n\n<!ELEMENT pkg (uid)*>\n<!ATTLIST pkg n CDATA #REQUIRED>\n\n<!ELEMENT uid (op)*>\n<!ATTLIST uid\nn CDATA #REQUIRED\np CDATA #IMPLIED>\n\n<!ELEMENT op (st)*>\n<!ATTLIST op\nn CDATA #REQUIRED\nm CDATA #REQUIRED>\n\n<!ELEMENT st EMPTY>\n<!ATTLIST st\nn CDATA #REQUIRED\nt CDATA #IMPLIED\nr CDATA #IMPLIED\nd CDATA #IMPLIED\npp CDATA #IMPLIED\npu CDATA #IMPLIED>\n\n]>\n")])]),a._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[a._v("1")]),e("br"),e("span",{staticClass:"line-number"},[a._v("2")]),e("br"),e("span",{staticClass:"line-number"},[a._v("3")]),e("br"),e("span",{staticClass:"line-number"},[a._v("4")]),e("br"),e("span",{staticClass:"line-number"},[a._v("5")]),e("br"),e("span",{staticClass:"line-number"},[a._v("6")]),e("br"),e("span",{staticClass:"line-number"},[a._v("7")]),e("br"),e("span",{staticClass:"line-number"},[a._v("8")]),e("br"),e("span",{staticClass:"line-number"},[a._v("9")]),e("br"),e("span",{staticClass:"line-number"},[a._v("10")]),e("br"),e("span",{staticClass:"line-number"},[a._v("11")]),e("br"),e("span",{staticClass:"line-number"},[a._v("12")]),e("br"),e("span",{staticClass:"line-number"},[a._v("13")]),e("br"),e("span",{staticClass:"line-number"},[a._v("14")]),e("br"),e("span",{staticClass:"line-number"},[a._v("15")]),e("br"),e("span",{staticClass:"line-number"},[a._v("16")]),e("br"),e("span",{staticClass:"line-number"},[a._v("17")]),e("br"),e("span",{staticClass:"line-number"},[a._v("18")]),e("br"),e("span",{staticClass:"line-number"},[a._v("19")]),e("br"),e("span",{staticClass:"line-number"},[a._v("20")]),e("br"),e("span",{staticClass:"line-number"},[a._v("21")]),e("br"),e("span",{staticClass:"line-number"},[a._v("22")]),e("br"),e("span",{staticClass:"line-number"},[a._v("23")]),e("br"),e("span",{staticClass:"line-number"},[a._v("24")]),e("br"),e("span",{staticClass:"line-number"},[a._v("25")]),e("br"),e("span",{staticClass:"line-number"},[a._v("26")]),e("br"),e("span",{staticClass:"line-number"},[a._v("27")]),e("br"),e("span",{staticClass:"line-number"},[a._v("28")]),e("br"),e("span",{staticClass:"line-number"},[a._v("29")]),e("br"),e("span",{staticClass:"line-number"},[a._v("30")]),e("br"),e("span",{staticClass:"line-number"},[a._v("31")]),e("br")])]),e("p",[a._v("The instructions below follows the exact order given above:")]),a._v(" "),e("ul",[e("li",[e("code",[a._v("app-ops")]),a._v(": The root element. It can contain any number of "),e("code",[a._v("pkg")]),a._v(" or package "),e("code",[a._v("uid")]),a._v(" "),e("ul",[e("li",[e("code",[a._v("v")]),a._v(": (optional, integer) The version number (default: "),e("code",[a._v("NO_VERSION")]),a._v(" or "),e("code",[a._v("-1")]),a._v(")")])])]),a._v(" "),e("li",[e("code",[a._v("pkg")]),a._v(": Stores package info. It can contain any number of "),e("code",[a._v("uid")]),a._v(" "),e("ul",[e("li",[e("code",[a._v("n")]),a._v(": (required, string) Name of the package")])])]),a._v(" "),e("li",[a._v("Package "),e("code",[a._v("uid")]),a._v(": Stores package or packages info\n"),e("ul",[e("li",[e("code",[a._v("n")]),a._v(": (required, integer) The user ID")])])]),a._v(" "),e("li",[e("code",[a._v("uid")]),a._v(": The package user ID. It can contain any number of "),e("code",[a._v("op")]),a._v(" "),e("ul",[e("li",[e("code",[a._v("n")]),a._v(": (required, integer) The user ID")]),a._v(" "),e("li",[e("code",[a._v("p")]),a._v(": (optional, boolean) Is the app is a private/system app")])])]),a._v(" "),e("li",[e("code",[a._v("op")]),a._v(": The operation, can contain "),e("code",[a._v("st")]),a._v(" or nothing at all\n"),e("ul",[e("li",[e("code",[a._v("n")]),a._v(": (required, integer) The op name in integer, ie. AppOpsManager.OP_*")]),a._v(" "),e("li",[e("code",[a._v("m")]),a._v(": (required, integer) The op mode, ie. AppOpsManager.MODE_*")])])]),a._v(" "),e("li",[e("code",[a._v("st")]),a._v(": State of operation: whether the operation is accessed, rejected or running (not available on old versions)\n"),e("ul",[e("li",[e("code",[a._v("n")]),a._v(": (required, long) Key containing flags and uid")]),a._v(" "),e("li",[e("code",[a._v("t")]),a._v(": (optional, long) Access time (default: "),e("code",[a._v("0")]),a._v(")")]),a._v(" "),e("li",[e("code",[a._v("r")]),a._v(": (optional, long) Reject time (default: "),e("code",[a._v("0")]),a._v(")")]),a._v(" "),e("li",[e("code",[a._v("d")]),a._v(": (optional, long) Access duration (default: "),e("code",[a._v("0")]),a._v(")")]),a._v(" "),e("li",[e("code",[a._v("pp")]),a._v(": (optional, string) Proxy package name")]),a._v(" "),e("li",[e("code",[a._v("pu")]),a._v(": (optional, integer) Proxy package uid")])])])]),a._v(" "),e("p",[a._v("This definition can be found at "),e("a",{attrs:{href:"https://android.googlesource.com/platform/frameworks/base/+/master/services/core/java/com/android/server/appop/AppOpsService.java",target:"_blank",rel:"noopener noreferrer"}},[e("strong",[a._v("AppOpsService")]),e("OutboundLink")],1),a._v(".")]),a._v(" "),e("h2",{attrs:{id:"appops-command-line-interface"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#appops-command-line-interface"}},[a._v("#")]),a._v(" appops command line interface")]),a._v(" "),e("p",[e("code",[a._v("appops")]),a._v(" or "),e("code",[a._v("cmd appops")]),a._v(" (on latest versions) can be accessible via ADB or root. This is an easier method to get or update any operation for a package (provided the package name is known). The help page of this command is self explanatory:")]),a._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[a._v("AppOps service (appops) commands:\nhelp\n  Print this help text.\nstart [--user <USER_ID>] <PACKAGE | UID> <OP> \n  Starts a given operation for a particular application.\nstop [--user <USER_ID>] <PACKAGE | UID> <OP> \n  Stops a given operation for a particular application.\nset [--user <USER_ID>] <[--uid] PACKAGE | UID> <OP> <MODE>\n  Set the mode for a particular application and operation.\nget [--user <USER_ID>] <PACKAGE | UID> [<OP>]\n  Return the mode for a particular application and optional operation.\nquery-op [--user <USER_ID>] <OP> [<MODE>]\n  Print all packages that currently have the given op in the given mode.\nreset [--user <USER_ID>] [<PACKAGE>]\n  Reset the given application or all applications to default modes.\nwrite-settings\n  Immediately write pending changes to storage.\nread-settings\n  Read the last written settings, replacing current state in RAM.\noptions:\n  <PACKAGE> an Android package name or its UID if prefixed by --uid\n  <OP>      an AppOps operation.\n  <MODE>    one of allow, ignore, deny, or default\n  <USER_ID> the user id under which the package is installed. If --user is not\n            specified, the current user is assumed.\n")])]),a._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[a._v("1")]),e("br"),e("span",{staticClass:"line-number"},[a._v("2")]),e("br"),e("span",{staticClass:"line-number"},[a._v("3")]),e("br"),e("span",{staticClass:"line-number"},[a._v("4")]),e("br"),e("span",{staticClass:"line-number"},[a._v("5")]),e("br"),e("span",{staticClass:"line-number"},[a._v("6")]),e("br"),e("span",{staticClass:"line-number"},[a._v("7")]),e("br"),e("span",{staticClass:"line-number"},[a._v("8")]),e("br"),e("span",{staticClass:"line-number"},[a._v("9")]),e("br"),e("span",{staticClass:"line-number"},[a._v("10")]),e("br"),e("span",{staticClass:"line-number"},[a._v("11")]),e("br"),e("span",{staticClass:"line-number"},[a._v("12")]),e("br"),e("span",{staticClass:"line-number"},[a._v("13")]),e("br"),e("span",{staticClass:"line-number"},[a._v("14")]),e("br"),e("span",{staticClass:"line-number"},[a._v("15")]),e("br"),e("span",{staticClass:"line-number"},[a._v("16")]),e("br"),e("span",{staticClass:"line-number"},[a._v("17")]),e("br"),e("span",{staticClass:"line-number"},[a._v("18")]),e("br"),e("span",{staticClass:"line-number"},[a._v("19")]),e("br"),e("span",{staticClass:"line-number"},[a._v("20")]),e("br"),e("span",{staticClass:"line-number"},[a._v("21")]),e("br"),e("span",{staticClass:"line-number"},[a._v("22")]),e("br"),e("span",{staticClass:"line-number"},[a._v("23")]),e("br"),e("span",{staticClass:"line-number"},[a._v("24")]),e("br"),e("span",{staticClass:"line-number"},[a._v("25")]),e("br")])])])}),[],!1,null,null,null);s.default=n.exports}}]);